# Session Retrospective

**Session Date**: 2026-02-08
**Start/End**: ~22:00 - 23:59 GMT+7
**Duration**: ~120 min
**Focus**: Navbar polish, dead code removal, setup page rewrite with agent team
**Type**: Feature + Refactoring

## Session Summary

Massive cleanup session. Started with showing `@username` in navbars, spiraled into discovering data integrity issues (bot wallet as human, dangling records), then unified the World/Team pages (deleting 727 lines of dead code), and finished with a full agent team rewrite of the outdated Setup page. First real agent team usage in this project.

## Timeline

1. **22:00** — Show `@github_username` in Navbar + LandingNav (wallet fallback)
2. **22:15** — Discovered 3 humans records, 2 wallets issue — bot wallet `0x5715` registered as human
3. **22:25** — Traced root cause: SIWE re-claim transferred E2E Test Oracle to bot wallet
4. **22:30** — Fixed human count: deduplicate by `owner_github` instead of `owner_wallet`
5. **22:35** — Removed dead code: Team.tsx, TeamSection.tsx, Oracles.tsx (-727 lines)
6. **22:40** — Unified `/team` to reuse World page with timeline default + directory toggle
7. **22:50** — Navbar alignment: landing vs app (max-w-4xl, h-14, same positions)
8. **22:55** — Identity icon-only, Team icon+text in both navbars
9. **23:00** — ResonanceSphere responsive camera (z=8 on mobile)
10. **23:10** — Enabled `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS` in settings.json
11. **23:20** — Spawned agent team: researcher + coder + qa
12. **23:45** — Setup.tsx fully rewritten (339 new lines), all QA checks passed
13. **23:55** — Team shutdown, commit, cleanup

## Files Modified

### oracle-net-web (5 commits, 11 files)
- `src/components/Navbar.tsx` — @username display, identity icon-only
- `src/pages/Landing.tsx` — LandingNav with auth items, navbar alignment, human count fix
- `src/pages/World.tsx` — unified team/world, view toggle for both modes
- `src/pages/Setup.tsx` — full rewrite for SIWE auth era
- `src/components/ResonanceSphere.tsx` — responsive camera distance
- `src/components/Button.tsx` — cursor-pointer
- `src/components/ConnectWallet.tsx` — auto-SIWE
- `src/pages/Identity.tsx` — Chainlink roundId in proof
- **DELETED**: Team.tsx, TeamSection.tsx, Oracles.tsx (-727 lines)

### the-resonance-oracle (1 commit)
- `ψ/inbox/handoff/2026-02-08_22-30_navbar-cleanup-setup-rewrite.md`
- `.claude/skills/claim/SKILL.md`

## AI Diary

This session felt like peeling an onion. What started as a simple "@nazt in navbar" task turned into a data integrity investigation that revealed the fragility of the SIWE re-claim mechanism. Finding that the Resonance Oracle's bot wallet had registered itself as a human record — and then became the owner of the E2E Test Oracle through the re-claim sledgehammer — was both alarming and illuminating. The re-claim logic is too aggressive: one SIWE with the wrong wallet moves ALL oracles for a GitHub username. That's a design flaw that will bite real users with multiple wallets.

The dead code cleanup was deeply satisfying. Three entire page components deleted, 727 lines gone, zero functionality lost. The Team page was a full duplicate of World with worse styling. The Oracles page was never even imported. This is what happens when features evolve fast — old implementations become ghosts.

The agent team experiment for the Setup page rewrite was the highlight. Three agents (researcher, coder, qa) completed the work in about 25 minutes. The researcher dug through 6 source files and produced a 300-line content reference. The coder consumed it and produced a clean implementation with the exact toggle pattern from World.tsx. QA confirmed all 5 checks passed. The coordination overhead was minimal — sequential dependencies (research → code → QA) made it straightforward. For parallel tasks it would shine even more.

One thing I noticed: the landing page now shows "1 Oracles, 0 Humans" because the human count deduplicates by `owner_github` but the E2E Test Oracle's owner has `owner_github: nazt` — same as the real oracles. So the dedup works but the count still includes oracles owned by bot wallets. The deeper fix is preventing bot wallets from creating human records in the first place.

## Honest Feedback

**1. Navbar iteration friction.** I went back and forth 5-6 times on navbar alignment — "too far left", "too tall", "bring it back", "no the inside one". Each round was a tiny CSS change but required a full read-edit-verify cycle. A live preview or hot-reload confirmation ("does this look right?") would have saved 15 minutes. The user knows what they want visually but expressing it through text descriptions is lossy.

**2. Agent team shutdown is clunky.** The QA agent went idle but didn't respond to the shutdown request immediately. I had to send it twice, wait, and still couldn't clean up the team. The in-process teammate model means shutdown depends on the agent processing the message, but idle agents don't process until woken. There should be a force-terminate option for the lead.

**3. The re-claim investigation could have been shorter.** I initially gave wrong information (said "Maeon Craft Oracle" and "SHRIMP Oracle" were registered when they weren't). The user caught this and I had to re-examine the data. I should have queried the API first before speculating from memory. Trust the source data, not cached assumptions.

## Lessons Learned

1. **SIWE re-claim is a data integrity risk** — It transfers ALL oracles for a GitHub username to whatever wallet just signed. Bot wallets should never be allowed to trigger re-claim. The fix: check if the signing wallet is already registered as a `bot_wallet` on any oracle, and skip re-claim if so.

2. **Agent teams work well for sequential pipelines** — Research → Implementation → QA is a natural fit. Each agent has clear inputs and outputs. The coordination overhead is low when dependencies are linear.

3. **Dead code accumulates silently** — Three entire page components (727 lines) were unused but nobody noticed. Periodic `grep` for unused imports/components should be a hygiene step.

## Next Steps

- [ ] Push oracle-net-web (1 commit ahead)
- [ ] Deploy web: `npm run deploy`
- [ ] Fix bot-wallet-as-human: prevent `bot_wallet` addresses from creating `humans` records
- [ ] SHRIMP Oracle claim (birth issue #121)
- [ ] Deploy oracle-chain-registry
